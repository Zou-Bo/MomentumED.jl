# MomentumED.jl

[![CI](https://github.com/Zou-Bo/MomentumED.jl/workflows/CI/badge.svg)](https://github.com/Zou-Bo/MomentumED.jl/actions/workflows/CI.yml)
[![Documentation](https://img.shields.io/badge/docs-stable-blue.svg)](https://Zou-Bo.github.io/MomentumED.jl/stable)
[![Documentation](https://img.shields.io/badge/docs-dev-blue.svg)](https://Zou-Bo.github.io/MomentumED.jl/dev)
[![Code Style](https://img.shields.io/badge/code%20style-blue-4495d1.svg)](https://github.com/JuliaFormatter/JuliaFormatter.jl)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

A Julia package for momentum-conserved exact diagonalization of quantum many-body systems.

## Overview

This package provides efficient tools for exact diagonalization of 2D quantum many-body systems in momentum space with momentum conservation.

To do list: mapping approach, scatter term with three or higher vertices, one-body reduced density matrix

All the documentations are generated by AI, and is full of illustrations. I'm trying to make revisements.


## Features

- **Momentum Block Diagonalization**: Exploits translational symmetry for computational efficiency
- **Multi-Component Systems**: Support for both conserved and non-conserved components
- **Flexible Interactions**: Custom one-body and two-body interaction functions
- **Sparse Matrix Methods**: Efficient Hamiltonian construction using KrylovKit
- **Entanglement Analysis**: Built-in tools for entanglement entropy calculations
- **Topological Tools**: Berry connection calculations for topological invariants

## Installation

```julia
using Pkg
Pkg.add(url="https://github.com/Zou-Bo/MomentumED.jl")
```

## Quick Start

```julia
using MomentumED

# Define k-mesh for 2D system
k_list = [0 1 2 0 1 2 0 1 2 0 1 2 0 1 2;
          0 0 0 1 1 1 2 2 2 3 3 3 4 4 4]

# Define interaction function
function V_int(k_coords_f1, k_coords_f2, k_coords_i1, k_coords_i2, cf1=1, cf2=1, ci1=1, ci2=1)
    # k_coords_* are tuples (kx, ky) already normalized by Gk
    # Your interaction potential here
    return 1.0 + 0.0im  # Simple constant interaction
end

# Create parameter structure
para = EDPara(k_list=k_list, Gk=(3, 5), V_int=V_int)

# Generate many-body states for 4 particles
mbs_list = ED_mbslist(para, 4)

# Divide into momentum blocks
blocks, block_k1, block_k2, k0number = ED_momentum_block_division(para, mbs_list)

# Generate scattering lists
scat_list1 = ED_sortedScatteringList_onebody(para)
scat_list2 = ED_sortedScatteringList_twobody(para)

# Solve first momentum block
energies, eigenvectors = EDsolve(blocks[1], scat_list1, scat_list2, 5)

println("Ground state energy: ", energies[1])
```

## API Reference

### Core Data Structures

- **EDPara**: Central parameter container for system configuration
- **MBS64{bits}**: Many-body state representation using bit encoding
- **Scattering{N}**: Hamiltonian term representation: usually N=1 or 2 for so-called "one/two-point scattering term"

### Main Functions

- **ED_mbslist()**: Generate many-body states for given particle number
- **ED_momentum_block_division()**: Divide Hilbert space into momentum blocks
- **ED_sortedScatteringList_onebody()**: Generate one-body scattering terms
- **ED_sortedScatteringList_twobody()**: Generate two-body scattering terms
- **EDsolve()**: Solve eigenvalue problem for momentum block using 
- **ED_etg_entropy()**: Calculate entanglement entropy
- **ED_connection_integral()**: Calculate Berry connection

### Multi-Component Systems

The package supports systems with multiple components:
- Conserved components (e.g., particle number in each layer)
- Non-conserved components (e.g., spin, orbital)
- Flexible orbital indexing scheme

## Performance

The package is optimized for performance:
- **Memory efficiency**: Bit encoding and sparse matrix methods
- **Parallel processing**: Multi-threaded computation
- **Block diagonalization**: Significantly reduced matrix sizes

Typical performance depends on system size and particle number.

## Examples

The package includes example notebooks:
- `examples/example1_FQH_Laughlin.ipynb`: Single-layer FQH system at filling factor 1/3
- `examples/example2_BilayerFQH_Halperin.ipynb`: Bilayer FQH system (3,3,1) Halperin state

## Documentation

Comprehensive documentation is available at:
- [Stable Documentation](https://Zou-Bo.github.io/MomentumED.jl/stable)
- [Development Documentation](https://Zou-Bo.github.io/MomentumED.jl/dev)

## License

This package is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Citation

If you use this package in your research, you might cite:

```bibtex
@software{MomentumED.jl,
  author = {Zou, Bo},
  title = {{MomentumED.jl}: A Julia Package for Exact Diagonalization with Momentum Conservation},
  year = {2025},
  publisher = {GitHub},
  journal = {GitHub repository},
  howpublished = {\url{https://github.com/Zou-Bo/MomentumED.jl}}
}
```