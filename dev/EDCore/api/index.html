<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · MomentumED.jl</title><meta name="title" content="API Reference · MomentumED.jl"/><meta property="og:title" content="API Reference · MomentumED.jl"/><meta property="twitter:title" content="API Reference · MomentumED.jl"/><meta name="description" content="Documentation for MomentumED.jl."/><meta property="og:description" content="Documentation for MomentumED.jl."/><meta property="twitter:description" content="Documentation for MomentumED.jl."/><meta property="og:url" content="https://Zou-Bo.github.io/MomentumED.jl/EDCore/api/"/><meta property="twitter:url" content="https://Zou-Bo.github.io/MomentumED.jl/EDCore/api/"/><link rel="canonical" href="https://Zou-Bo.github.io/MomentumED.jl/EDCore/api/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MomentumED.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">EDCore</span><ul><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Many-Body-Basis"><span>Many-Body Basis</span></a></li><li><a class="tocitem" href="#Hilbert-Subspace"><span>Hilbert Subspace</span></a></li><li><a class="tocitem" href="#Many-Body-Vector"><span>Many-Body Vector</span></a></li><li><a class="tocitem" href="#Scattering-Term"><span>Scattering Term</span></a></li><li><a class="tocitem" href="#Many-Body-Operator"><span>Many-Body Operator</span></a></li><li><a class="tocitem" href="#Multiplication-and-Bracket"><span>Multiplication and Bracket</span></a></li><li><a class="tocitem" href="#End"><span>End</span></a></li></ul></li></ul></li><li><span class="tocitem">MomentumED</span><ul><li><a class="tocitem" href="../../MomentumED/api/">API Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">EDCore</a></li><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Zou-Bo/MomentumED.jl/blob/main/docs/src/EDCore/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="EDCore-API-Reference"><a class="docs-heading-anchor" href="#EDCore-API-Reference">EDCore API Reference</a><a id="EDCore-API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#EDCore-API-Reference" title="Permalink"></a></h1><h2 id="Many-Body-Basis"><a class="docs-heading-anchor" href="#Many-Body-Basis">Many-Body Basis</a><a id="Many-Body-Basis-1"></a><a class="docs-heading-anchor-permalink" href="#Many-Body-Basis" title="Permalink"></a></h2><h3 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.MBS64" href="#EDCore.MBS64"><code>EDCore.MBS64</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MBS64{bits}</code></pre><p>Many-body state representation using 64-bit unsigned integers.</p><p>Each bit represents the occupation of an orbital (1 = occupied, 0 = empty). The <code>bits</code> parameter specifies how many orbitals are physically meaningful.</p><p><strong>Fields</strong></p><ul><li><code>n::UInt64</code>: The bit representation of occupied orbitals</li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">MBS64{bits}(state::UInt64)</code></pre><p>Creates a new MBS64 with the given bit state, validating that the state fits within the specified number of bits.</p><p><strong>Reinterpret Construction Example</strong></p><pre><code class="language-julia hljs">reinterpret(MBS64{20}, UInt(250))</code></pre><p>This may generate an unphysical state because <code>reinterpret</code> bypasses the constructor&#39;s validation, potentially setting bits beyond the <code>bits</code> parameter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Tuple{IO, MBS64}" href="#Base.show-Tuple{IO, MBS64}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, mbs::MBS64{bits}) where bits</code></pre><p>Display the MBS64 state in a human-readable format showing the bit pattern.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L34-L38">source</a></section></article><h3 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.get_bits-Union{Tuple{MBS64{bits}}, Tuple{bits}} where bits" href="#EDCore.get_bits-Union{Tuple{MBS64{bits}}, Tuple{bits}} where bits"><code>EDCore.get_bits</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_bits(mbs::MBS64{bits}) = bits</code></pre><p>Return the number of physical bits of the type of input mbs state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L48-L52">source</a></section><section><div><pre><code class="language-julia hljs">get_bits(space::HilbertSubspace{bits})::Integer</code></pre><p>Returns the number of bits used to represent the MBS64 states in the Hilbert subspace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.isphysical" href="#EDCore.isphysical"><code>EDCore.isphysical</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isphysical(mbs::MBS64{bits})::Bool</code></pre><p>Check if all indices of occupied orbitals are smaller than or equal to bits.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.occ_list" href="#EDCore.occ_list"><code>EDCore.occ_list</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">occ_list(mbs::MBS64{bits}) where {bits}</code></pre><p>Return the list of occupied orbital indices (1-based) in the many-body state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L126-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.make_mask64" href="#EDCore.make_mask64"><code>EDCore.make_mask64</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_mask64(occ_list::Vector{Int64})::UInt64
make_mask64(occ_list)::UInt64 = make_mask64(collect(occ_list))
make_mask64(occ_list::Tuple{Int64})::UInt64
make_mask64(occ_list::Tuple{Int64, Int64})::UInt64</code></pre><p>Create mask with ones on the assigned bit positions. Bit positions should be &gt;= 1 and &lt;= 64. Repeating positions only take effect once.</p><p>Optimized for one and two occupations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L142-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.MBS64-Tuple{Any, Any}" href="#EDCore.MBS64-Tuple{Any, Any}"><code>EDCore.MBS64</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MBS64(bits, occ_list[, mask])</code></pre><p>Construct an MBS64 from an iterable list of occupied orbitals.  No repetition allowed.</p><p>If a mask is specified, <code>occ_list</code> refers to the indices within that mask that should be set to occupied. For example, if <code>mask</code> represents orbitals [1, 3, 5] and <code>occ_list</code> is [1, 2], then orbitals 1 and 3 (from the mask) will be occupied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L177-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.MBS64_complete" href="#EDCore.MBS64_complete"><code>EDCore.MBS64_complete</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MBS64_complete(mbs::MBS64{bits})::MBS64{bits}</code></pre><p>Return the complete occupation of a <code>MBS64{bits}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L195-L199">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Union{Tuple{b}, Tuple{MBS64{b}, MBS64{b}}} where b" href="#Base.:*-Union{Tuple{b}, Tuple{MBS64{b}, MBS64{b}}} where b"><code>Base.:*</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">*(mbs1::MBS64{b1}, mbs2::MBS64{b2}) where {b1, b2}</code></pre><p>Combine(concatenate) two MBS64 states from two orthogonal Hilbert spaces. The first state accounts greater bit positions and the second smaller positions. Used for combining states from different components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L74-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Union{Tuple{b}, Tuple{MBS64{b}, MBS64{b}}} where b" href="#Base.:+-Union{Tuple{b}, Tuple{MBS64{b}, MBS64{b}}} where b"><code>Base.:+</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">+(mbs1::MBS64{b}, mbs2::MBS64{b})::MBS64{b} where {b}</code></pre><p>Combine(plus) two MBS64 states in the same(combined) Hilbert space with mbs1.n | mbs2.n. Used for combining states generated with complete masks. Repeated occupations on the same bit, if exist, count once.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L85-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.isless-Union{Tuple{b}, Tuple{MBS64{b}, MBS64{b}}} where b" href="#Base.isless-Union{Tuple{b}, Tuple{MBS64{b}, MBS64{b}}} where b"><code>Base.isless</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isless(mbs1::MBS64{b}, mbs2::MBS64{b}) where {b}</code></pre><p>Comparison operators for sorting MBS64 states.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L96-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:==-Union{Tuple{b2}, Tuple{b1}, Tuple{MBS64{b1}, MBS64{b2}}} where {b1, b2}" href="#Base.:==-Union{Tuple{b2}, Tuple{b1}, Tuple{MBS64{b1}, MBS64{b2}}} where {b1, b2}"><code>Base.:==</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">==(mbs1::MBS64{b1}, mbs2::MBS64{b2}) where {b1, b2}
==(int::Integer, mbs2::MBS64{b}) where {b}
==(mbs1::MBS64{b}, int::Integer) where {b}</code></pre><p>Check equality of two MBS64 states. Different bit sizes are never equal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L104-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.hash-Tuple{MBS64}" href="#Base.hash-Tuple{MBS64}"><code>Base.hash</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hash(mbs::MBS64) = hash(mbs.n)</code></pre><p>Computes the hash of a many-body state, which is equivalent to the hash of its underlying integer representation <code>mbs.n</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.isoccupied" href="#EDCore.isoccupied"><code>EDCore.isoccupied</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isoccupied(mbs::MBS64{bits}, i_list::UInt64) where {bits}
isoccupied(mbs::MBS64{bits}, i_list::Vector{Int64}) where {bits}
isoccupied(mbs::MBS64{bits}, i_list::Tuple{Vararg{Int64}}) where {bits}</code></pre><p>Check if the specified orbital(s) are all occupied in the many-body state. Returns true if all specified orbitals are occupied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L204-L211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.isempty-Union{Tuple{bits}, Tuple{MBS64{bits}, UInt64}} where bits" href="#Base.isempty-Union{Tuple{bits}, Tuple{MBS64{bits}, UInt64}} where bits"><code>Base.isempty</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isempty(mbs::MBS64{bits}, i_list::UInt64) where {bits}
isempty(mbs::MBS64{bits}, i_list::Vector{Int64}) where {bits}
isempty(mbs::MBS64{bits}, i_list::Tuple{Vararg{Int64}}) where {bits}</code></pre><p>Check if the specified orbital(s) are all empty in the many-body state. Returns true if all specified orbitals are empty.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L232-L239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.occupy!" href="#EDCore.occupy!"><code>EDCore.occupy!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">occupy!(mbs::MBS64{bits}, i_list::UInt64; check::Bool=true) where {bits}
occupy!(mbs::MBS64{bits}, i_list::Vector{Int64}; check::Bool=true) where {bits}
occupy!(mbs::MBS64{bits}, i_list::Tuple{Vararg{Int64}}; check::Bool=true) where {bits}</code></pre><p>Create a new MBS64 with the specified orbital(s) occupied. If check=true, verifies that the orbitals were originally empty.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L260-L267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.empty!-Union{Tuple{bits}, Tuple{MBS64{bits}, UInt64}} where bits" href="#Base.empty!-Union{Tuple{bits}, Tuple{MBS64{bits}, UInt64}} where bits"><code>Base.empty!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">empty!(mbs::MBS64{bits}, i_list::UInt64; check::Bool=true) where {bits}
empty!(mbs::MBS64{bits}, i_list::Vector{Int64}; check::Bool=true) where {bits}
empty!(mbs::MBS64{bits}, i_list::Tuple{Vararg{Int64}}; check::Bool=true) where {bits}</code></pre><p>Create a new MBS64 with the specified orbital(s) emptied. If check=true, verifies that the orbitals were originally occupied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L303-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.flip!" href="#EDCore.flip!"><code>EDCore.flip!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flip!(mbs::MBS64{bits}, i_list::UInt64) where {bits}
flip!(mbs::MBS64{bits}, i_list::Vector{Int64}) where {bits}
flip!(mbs::MBS64{bits}, i_list::Tuple{Vararg{Int64}}) where {bits}</code></pre><p>Create a new MBS64 with flipped occupations in the specified orbital(s).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L346-L352">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.scat_occ_number" href="#EDCore.scat_occ_number"><code>EDCore.scat_occ_number</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scat_occ_number(mbs::MBS64{bits}, i_list::Vector{Int64})::Int64 where {bits}
scat_occ_number(mbs::MBS64{bits}, i_list::Tuple{Vararg{Int64}})::Int64 where {bits}
scat_occ_number(mbs::MBS64{bits}, i_list::Tuple{Int64})::Int64 where {bits}
scat_occ_number(mbs::MBS64{bits}, i_list::Tuple{Int64, Int64})::Int64 where {bits}</code></pre><p>Count the total number of occupied orbitals that contribute to the sign flip when applying a series of creation/annihilation operators. When a Scatter{N} object is applied, the number of sign flips should be the sum of  applying the creation i<em>list and annihilation i</em>list on the middle state.</p><p>Optimized for one-body and two-body Scatter with Tuple input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L373-L384">source</a></section></article><h3 id="Generating-Sorted-List"><a class="docs-heading-anchor" href="#Generating-Sorted-List">Generating Sorted List</a><a id="Generating-Sorted-List-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-Sorted-List" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.ColexMBS64" href="#EDCore.ColexMBS64"><code>EDCore.ColexMBS64</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The Combinations iterator in colex order (meaning sorted MBS64 list)</p><pre><code class="language-julia hljs">for mbs in ColexMBS64(7, 3)
    println(mbs)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/colex_mbslist.jl#L2-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.ColexMBS64Mask" href="#EDCore.ColexMBS64Mask"><code>EDCore.ColexMBS64Mask</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>The Combinations iterator in colex order where occupied orbitals are in the mask. Returning list is sorted when the mask is sorted.</p><pre><code class="language-julia hljs">for mbs in ColexMBS64Mask(7, 3, [1; 2; 5; 6; 7])
    println(mbs)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/colex_mbslist.jl#L43-L53">source</a></section></article><h2 id="Hilbert-Subspace"><a class="docs-heading-anchor" href="#Hilbert-Subspace">Hilbert Subspace</a><a id="Hilbert-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Hilbert-Subspace" title="Permalink"></a></h2><h3 id="Types-2"><a class="docs-heading-anchor" href="#Types-2">Types</a><a class="docs-heading-anchor-permalink" href="#Types-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.HilbertSubspace" href="#EDCore.HilbertSubspace"><code>EDCore.HilbertSubspace</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HilbertSubspace{bits}</code></pre><p>Represents a Hilbert subspace defined by a list of many-body states (MBS64). Optionally includes a dictionary for efficient state-to-index lookup.</p><p><strong>Fields</strong></p><ul><li><code>list::Vector{MBS64{bits}}</code>: A sorted list of MBS64 states forming the basis of the subspace.</li><li><code>dict::Dict{MBS64{bits}, &lt;: Integer}</code>: An optional dictionary mapping MBS64 states to their 1-based indices in <code>list</code>.</li></ul><p>Notice that dict takes lots of memory and can only accelerate searching in very very large subspace.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">HilbertSubspace(sorted_list::Vector{MBS64{bits}}; dict::Bool = false, index_type::Type = Int64) where {bits}</code></pre><p>Constructs a <code>HilbertSubspace</code> from a sorted list of MBS64 states. If <code>dict</code> is true, a state-to-index dictionary is pre-built.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L43-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, HilbertSubspace}" href="#Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, HilbertSubspace}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, mime::MIME&quot;text/plain&quot;, space::HilbertSubspace{bits}) where {bits}</code></pre><p>Displays a human-readable representation of the HilbertSubspace, including its bit size, dimension, and whether a dictionary is present.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L102-L106">source</a></section></article><h3 id="Functions-2"><a class="docs-heading-anchor" href="#Functions-2">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-2" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.idtype" href="#EDCore.idtype"><code>EDCore.idtype</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">idtype(space::HilbertSubspace)::Type</code></pre><p>Returns the type of the index used in the HilbertSubspace&#39;s dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.get_bits-Tuple{HilbertSubspace}" href="#EDCore.get_bits-Tuple{HilbertSubspace}"><code>EDCore.get_bits</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_bits(mbs::MBS64{bits}) = bits</code></pre><p>Return the number of physical bits of the type of input mbs state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_basis.jl#L48-L52">source</a></section><section><div><pre><code class="language-julia hljs">get_bits(space::HilbertSubspace{bits})::Integer</code></pre><p>Returns the number of bits used to represent the MBS64 states in the Hilbert subspace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{HilbertSubspace}" href="#Base.length-Tuple{HilbertSubspace}"><code>Base.length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">length(space::HilbertSubspace)</code></pre><p>Returns the number of states in the Hilbert subspace (space dimension).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L95-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.make_dict!" href="#EDCore.make_dict!"><code>EDCore.make_dict!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_dict!(space::HilbertSubspace; index_type::Type = idtype(space))</code></pre><p>Creates or recreates the state-to-index dictionary for the given HilbertSubspace. This can be useful if the <code>dict</code> field was not initialized or was emptied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L112-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.delete_dict!" href="#EDCore.delete_dict!"><code>EDCore.delete_dict!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete_dict!(space::HilbertSubspace)</code></pre><p>Deletes (empties) the state-to-index dictionary from the HilbertSubspace to free up memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L122-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.get-Union{Tuple{bits}, Tuple{HilbertSubspace{bits}, MBS64{bits}}} where bits" href="#Base.get-Union{Tuple{bits}, Tuple{HilbertSubspace{bits}, MBS64{bits}}} where bits"><code>Base.get</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.get(space::HilbertSubspace{bits}, mbs::MBS64{bits})::Int64</code></pre><p>Retrieves the index of a given many-body state within the Hilbert subspace. If a dictionary is available, it uses it for O(1) lookup; otherwise, it falls back to sorted list search. Returns 0 if the state is not found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L131-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.get_from_list" href="#EDCore.get_from_list"><code>EDCore.get_from_list</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_from_list(space::HilbertSubspace{bits}, mbs::MBS64{bits})::Int64</code></pre><p>Retrieves the index of a given many-body state within the Hilbert subspace by searching the state list. This method does not use the dictionary, even if it exists. Returns 0 if the state is not found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L146-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.get_from_dict" href="#EDCore.get_from_dict"><code>EDCore.get_from_dict</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_from_dict(space::HilbertSubspace{bits}, mbs::MBS64{bits})::Int64</code></pre><p>Retrieves the index of a given many-body state within the Hilbert subspace using the pre-built dictionary. This method requires the dictionary to be non-empty. Returns 0 if the state is not found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/hilbert_subspace.jl#L157-L163">source</a></section></article><h2 id="Many-Body-Vector"><a class="docs-heading-anchor" href="#Many-Body-Vector">Many-Body Vector</a><a id="Many-Body-Vector-1"></a><a class="docs-heading-anchor-permalink" href="#Many-Body-Vector" title="Permalink"></a></h2><h3 id="Types-3"><a class="docs-heading-anchor" href="#Types-3">Types</a><a class="docs-heading-anchor-permalink" href="#Types-3" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.MBS64Vector" href="#EDCore.MBS64Vector"><code>EDCore.MBS64Vector</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct MBS64Vector{bits, F &lt;: AbstractFloat}
    vec::Vector{Complex{F}}
    space::HilbertSubspace{bits}
end</code></pre><p>A vector of components bounded to a <code>HilbertSubspace</code> that defines the space and basis. It represents a general many-body state in the basis of the given <code>MBS64{bits}</code> list.</p><p>To save the memory usage, use the same <code>HilbertSubspace</code> for all <code>MBS64Vector</code>s in the same subspace.</p><p>Constructor:</p><pre><code class="language-julia hljs">MBS64Vector(vec::Vector{Complex{F}}, space::HilbertSubspace{bits}) where {bits, F &lt;: AbstractFloat}</code></pre><p>Constructs an <code>MBS64Vector</code> from a vector of complex coefficients and a <code>HilbertSubspace</code>. The length of the vector must match the dimension of the Hilbert subspace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_vector.jl#L3-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Union{Tuple{F}, Tuple{bits}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, MBS64Vector{bits, F}}} where {bits, F&lt;:AbstractFloat}" href="#Base.show-Union{Tuple{F}, Tuple{bits}, Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, MBS64Vector{bits, F}}} where {bits, F&lt;:AbstractFloat}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, mime::MIME&quot;text/plain&quot;, mbs_vec::MBS64Vector{bits, F}) where {bits, F &lt;: AbstractFloat}</code></pre><p>Displays a human-readable representation of the <code>MBS64Vector</code>, including its type parameters and the underlying vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_vector.jl#L33-L37">source</a></section></article><h3 id="Functions-3"><a class="docs-heading-anchor" href="#Functions-3">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-3" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{MBS64Vector}" href="#Base.length-Tuple{MBS64Vector}"><code>Base.length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">length(mbs_vec::MBS64Vector)</code></pre><p>Returns the length of the <code>MBS64Vector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_vector.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size-Tuple{MBS64Vector}" href="#Base.size-Tuple{MBS64Vector}"><code>Base.size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">size(mbs_vec::MBS64Vector)</code></pre><p>Returns the size of the <code>MBS64Vector</code> as a tuple (length,).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_vector.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.similar-Tuple{MBS64Vector}" href="#Base.similar-Tuple{MBS64Vector}"><code>Base.similar</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">similar(mbs_vec::MBS64Vector{bits, F})::MBS64Vector{bits, F} where {bits, F &lt;: AbstractFloat}</code></pre><p>Creates a new <code>MBS64Vector</code> with the same <code>HilbertSubspace</code> and element type, but with uninitialized contents.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_vector.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.dot-Union{Tuple{F}, Tuple{bits}, Tuple{MBS64Vector{bits, F}, MBS64Vector{bits, F}}} where {bits, F&lt;:AbstractFloat}" href="#LinearAlgebra.dot-Union{Tuple{F}, Tuple{bits}, Tuple{MBS64Vector{bits, F}, MBS64Vector{bits, F}}} where {bits, F&lt;:AbstractFloat}"><code>LinearAlgebra.dot</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dot(mbs_bra::MBS64Vector{bits, F}, mbs_ket::MBS64Vector{bits, F})::Complex{F}
mbs_bra ⋅ mbs_ket</code></pre><p>Computes the dot product between two <code>MBS64Vector</code>s. Both vectors must belong to the same Hilbert subspace.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/manybodystate_vector.jl#L76-L82">source</a></section></article><h2 id="Scattering-Term"><a class="docs-heading-anchor" href="#Scattering-Term">Scattering Term</a><a id="Scattering-Term-1"></a><a class="docs-heading-anchor-permalink" href="#Scattering-Term" title="Permalink"></a></h2><h3 id="Types-4"><a class="docs-heading-anchor" href="#Types-4">Types</a><a class="docs-heading-anchor-permalink" href="#Types-4" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.Scatter" href="#EDCore.Scatter"><code>EDCore.Scatter</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Scatter{N} - Represents an N-body Scatter term in the Hamiltonian

Fields:
- Amp::ComplexF64: Scatter amplitude
- out::NTuple{N, Int64}: Output orbital indices (creation operators)
- in::NTuple{N, Int64}: Input orbital indices (annihilation operators)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L7-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.NormalScatter" href="#EDCore.NormalScatter"><code>EDCore.NormalScatter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NormalScatter(V::ComplexF64, out_in::Int64...; upper_hermitian::Bool = false)::Scatter</code></pre><p>Generate a scattering term with normal ordering. Optimized for N=1,2.</p><p>term: V * c†<em>i1 c†</em>i2 ... c†<em>iN c</em>jN ... c<em>j2 c</em>j1 (j-in, i-out )</p><ul><li>(1) j1 &gt; j2 &gt; ... &gt; jN (no equality)</li><li>(2) i1 &gt; i2 &gt; ... &gt; iN (no equality)</li><li>Hermitian Upper Triangular:</li></ul><p>(3) j1 &gt; i1 or j1 = i1 &amp;&amp; j2 &gt; i2 or j1,j2 = i1,i2 &amp;&amp; j3 &gt; i3 or ... or j1,...,jN-1 = i1,...,iN-1 &amp;&amp; jN &gt;= iN</p><p>or equlivently in Julia&#39;s grammer</p><p>(3&#39;) (j1,...,jN) &gt;= (i1,...,iN)</p><p>Example:</p><pre><code class="language-julia hljs">NormalScatter(1.0+0.0im, 5, 3; upper_hermitian=true) == Scatter(-1.0+0.0im, 3, 5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L62-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.Scatter-Tuple{Any, Vararg{Int64}}" href="#EDCore.Scatter-Tuple{Any, Vararg{Int64}}"><code>EDCore.Scatter</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Scatter(V, out_in::Int64...)</code></pre><p>Construct a Scatter term from amplitude and orbital indices.  However, it&#39;s recommemded to use <code>NormalScatter</code> for construction.</p><p>The constructor expects an even number of indices, where the first half are output indices (creation operators) and the second half are input indices (annihilation operators), in reverse order for proper normal ordering.</p><p><strong>Arguments</strong></p><ul><li><code>V::Number</code>: Scatter amplitude (converted to ComplexF64)</li><li><code>out_in::Int64...</code>: Variable number of orbital indices (must be even)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># One-body: V * c†_i c_j
s1 = Scatter(1.0, 1, 2)  # Creates c†_1 c_2 term

# Two-body: V * c†_i1 c†_i2 c_j2 c_j1  
s2 = Scatter(0.5, 1, 2, 4, 3)  # Creates c†_1 c†_2 c_4 c_3 term</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L21-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Union{Tuple{N}, Tuple{IO, Scatter{N}}} where N" href="#Base.show-Union{Tuple{N}, Tuple{IO, Scatter{N}}} where N"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, st::Scatter{N})</code></pre><p>Display a scattering term in a readable format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L53-L57">source</a></section></article><h3 id="Functions-4"><a class="docs-heading-anchor" href="#Functions-4">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-4" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.get_body" href="#EDCore.get_body"><code>EDCore.get_body</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_body(::Scatter{N}) = N</code></pre><p>Return number of body.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L177-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.isnormal" href="#EDCore.isnormal"><code>EDCore.isnormal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>docstring needed</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L168-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.isnormalupper" href="#EDCore.isnormalupper"><code>EDCore.isnormalupper</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>docstring needed</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L172-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.isdiagonal" href="#EDCore.isdiagonal"><code>EDCore.isdiagonal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isdiagonal(s::Scatter)::Bool</code></pre><p>s.in == s.out</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L193-L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.adjoint-Union{Tuple{Scatter{N}}, Tuple{N}} where N" href="#Base.adjoint-Union{Tuple{Scatter{N}}, Tuple{N}} where N"><code>Base.adjoint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adjoint(s::Scatter{N})::Scatter{N}</code></pre><p>Create a reverse scattering term: exchange incident and output orbitals and conjugate amplitude.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L185-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.isless-Union{Tuple{N2}, Tuple{N1}, Tuple{Scatter{N1}, Scatter{N2}}} where {N1, N2}" href="#Base.isless-Union{Tuple{N2}, Tuple{N1}, Tuple{Scatter{N1}, Scatter{N2}}} where {N1, N2}"><code>Base.isless</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isless(s1::Scatter{N1}, s2::Scatter{N2})::Bool</code></pre><p>Irrelevant to  amplitute, compare scattering types.</p><p>N1 &lt; N2; if equal, s1.in &lt; s2.in; if equal, s1.out &lt; s2.out.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L203-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:==-Union{Tuple{N2}, Tuple{N1}, Tuple{Scatter{N1}, Scatter{N2}}} where {N1, N2}" href="#Base.:==-Union{Tuple{N2}, Tuple{N1}, Tuple{Scatter{N1}, Scatter{N2}}} where {N1, N2}"><code>Base.:==</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">==(s1::Scatter{N1}, s2::Scatter{N2})::Bool</code></pre><p>Irrelevant to  amplitute, check if the scattering types are the same.</p><p>N1 == N2, and s1.in == s2.in, and s1.out == s2.out.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L213-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Union{Tuple{N}, Tuple{Scatter{N}, Scatter{N}}} where N" href="#Base.:+-Union{Tuple{N}, Tuple{Scatter{N}, Scatter{N}}} where N"><code>Base.:+</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s1::Scatter{N} + s2::Scatter{N} -&gt; sum::Scatter{N}</code></pre><p>Combine the amplitutes of the two terms of the same type. </p><p>(N1 == N2) and s1.in == s2.in and s1.out == s2.out.</p><p>Return a scattering term with summing amplitute.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L223-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Union{Tuple{N}, Tuple{Number, Scatter{N}}} where N" href="#Base.:*-Union{Tuple{N}, Tuple{Number, Scatter{N}}} where N"><code>Base.:*</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">a::Number * s::Scatter{N} -&gt; s&#39;::Scatter{N}</code></pre><p>Return a scattering term with amplitute multiplied a number.</p><p>The number should be able to converted as ComplexF64.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L236-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.sort_merge_scatlist" href="#EDCore.sort_merge_scatlist"><code>EDCore.sort_merge_scatlist</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sort_merge_scatlist(lists; keywords)</code></pre><p>Sort and merge a list (lists) of normalized Scatter terms.</p><p><strong>Input</strong></p><ul><li>(1) lists::Vector{Scatter{N}}:</li></ul><p>Return a sorted and merged list: Vector{Scatter{N}}</p><ul><li>(2) lists::Vector{Scatter}:</li></ul><p>Grouping scattering terms by their N, then sorting and merging each group.  Return a list of sorted and merged lists: Vector{Vector{&lt;: Scatter}}, each inner list has a specified N.</p><ul><li>(3) lists::Vector{Vector{&lt;:Scatter}}:</li></ul><p>Similar to (2). Return a list of sorted and merged lists: Vector{Vector{&lt;: Scatter}}, each inner list has a specified N.</p><p><strong>Keywords</strong></p><ul><li><code>check_normal::Bool</code> = true: checking all the scatting terms are in nomal order</li><li><code>check_normalupper::Bool</code> = true: checking all the scatting terms are in nomal order and is in the upper triangular position.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/scattering.jl#L250-L268">source</a></section></article><h2 id="Many-Body-Operator"><a class="docs-heading-anchor" href="#Many-Body-Operator">Many-Body Operator</a><a id="Many-Body-Operator-1"></a><a class="docs-heading-anchor-permalink" href="#Many-Body-Operator" title="Permalink"></a></h2><h3 id="Types-5"><a class="docs-heading-anchor" href="#Types-5">Types</a><a class="docs-heading-anchor-permalink" href="#Types-5" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.MBOperator" href="#EDCore.MBOperator"><code>EDCore.MBOperator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct MBOperator
    scats::Vector{Vector{&lt;:Scatter}}
    upper_hermitian::Bool
end</code></pre><p>Represents a many-body operator as a list of lists of <code>Scatter</code> terms.</p><p><strong>Fields</strong></p><ul><li><code>scats::Vector{Vector{&lt;:Scatter}}</code>: A vector of vectors, where each inner vector contains <code>Scatter{N}</code> terms.</li><li><code>upper_hermitian::Bool</code>: Indicates whether the operator is upper Hermitian, affecting how terms are handled.</li></ul><p>In the construction of operators, all <code>Scatter</code> terms are automatically reorganized by their body number. Terms of the same scatter-in and -out states are merged. Terms of the same body number are sorted</p><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">MBOperator(scats::Vector{&lt;: Scatter}...; upper_hermitian::Bool)
MBOperator(scats::Vector{Vector{&lt;:Scatter}}; upper_hermitian::Bool)</code></pre><p>Constructs an <code>MBOperator</code> from input <code>Scatter</code> terms. The <code>upper_hermitian</code> flag determines how scattering terms are sorted and merged.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/operator.jl#L3-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Tuple{IO, MBOperator}" href="#Base.show-Tuple{IO, MBOperator}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, op::MBOperator)</code></pre><p>Displays a human-readable representation of the <code>MBOperator</code>, including its <code>upper_hermitian</code> status and the number of scattering terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/operator.jl#L55-L59">source</a></section></article><h3 id="Functions-5"><a class="docs-heading-anchor" href="#Functions-5">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-5" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.isupper" href="#EDCore.isupper"><code>EDCore.isupper</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isupper(op::MBOperator)::Bool</code></pre><p>Returns <code>true</code> if the operator is upper Hermitian, <code>false</code> otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/operator.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.adjoint-Tuple{MBOperator}" href="#Base.adjoint-Tuple{MBOperator}"><code>Base.adjoint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adjoint(op::MBOperator)::MBOperator</code></pre><p>Computes the adjoint of the operator <code>op</code> by creating a deep copy and then applying <code>adjoint!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/operator.jl#L84-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.adjoint!-Tuple{MBOperator}" href="#LinearAlgebra.adjoint!-Tuple{MBOperator}"><code>LinearAlgebra.adjoint!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adjoint!(op::MBOperator)::MBOperator</code></pre><p>Computes the adjoint of the operator <code>op</code> in-place. If the operator is not upper Hermitian, it adjoints each scattering term.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/types/operator.jl#L67-L72">source</a></section></article><h2 id="Multiplication-and-Bracket"><a class="docs-heading-anchor" href="#Multiplication-and-Bracket">Multiplication and Bracket</a><a id="Multiplication-and-Bracket-1"></a><a class="docs-heading-anchor-permalink" href="#Multiplication-and-Bracket" title="Permalink"></a></h2><h3 id="Functions-6"><a class="docs-heading-anchor" href="#Functions-6">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-6" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Scatter, MBS64}" href="#Base.:*-Tuple{Scatter, MBS64}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scat * (amp_in::ComplexF64, mbs_in::MBS64) -&gt; (amp_out::ComplexF64, mbs_out::MBS64)
scat * mbs_in::MBS64 = scat * (1.0, mbs_in)</code></pre><p>Applying a scatter operator on a many-body basis. Return the amplitute and the output many-body basis.</p><p>The amplitute is zero if no output state.</p><p>Notice: this multiplication assumes <code>scat</code> is normal. Using abnormal <code>Scatter</code> term will generate same result as if its indices are sorted, which may cause a sign error. It is recommended to always use <code>NormalScatter</code> to create <code>Scatter</code> terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/multiplication.jl#L5-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{MBS64, Scatter}" href="#Base.:*-Tuple{MBS64, Scatter}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(amp_out::ComplexF64, mbs_out::MBS64) * scat -&gt; (amp_in::ComplexF64, mbs_in::MBS64)
mbs_out::MBS64 * scat = (1.0, mbs_out) * scat</code></pre><p>Applying a scatter operator on a output many-body basis from the right. Return the amplitute and the incident many-body basis.</p><p>The amplitute is zero if no incident state.</p><p>Notice: this multiplication assumes <code>scat</code> is normal. Using abnormal <code>Scatter</code> term will generate same result as if its indices are sorted, which may cause a sign error. It is recommended to always use <code>NormalScatter</code> to create <code>Scatter</code> terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/multiplication.jl#L50-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{MBOperator, MBS64Vector}" href="#Base.:*-Tuple{MBOperator, MBS64Vector}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">op::MBOperator * mbs_vec::MBS64Vector -&gt; mbs_vec_result::MBS64Vector
op2::MBOperator * op1::MBOperator * mbs_vec::MBS64Vector -&gt; mbs_vec_result::MBS64Vector</code></pre><p>Applying one or two operators on a many-body state. More number of operators is not supported and should be implemented in steps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/multiplication.jl#L137-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.ED_bracket" href="#EDCore.ED_bracket"><code>EDCore.ED_bracket</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ED_bracket(mbs_vec_bra::MBS64Vector{bits, eltype}, 
    op::MBOperator, mbs_vec_ket::MBS64Vector{bits, eltype}
    )::Complex{eltype} where {bits, eltype &lt;: AbstractFloat}
ED_bracket(mbs_vec_bra::MBS64Vector{bits, eltype}, 
    op2::MBOperator, op1::MBOperator, mbs_vec_ket::MBS64Vector{bits, eltype}
    )::Complex{eltype} where {bits, eltype &lt;: AbstractFloat}</code></pre><p>Compute the bracket &lt;bra::MBS64Vector | op::MBOperator | ket::MBS64Vector&gt;</p><p>or the bracket &lt;bra::MBS64Vector | op2::MBOperator * op1::MBOperator | ket::MBS64Vector&gt;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/multiplication.jl#L269-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EDCore.ED_bracket_threaded" href="#EDCore.ED_bracket_threaded"><code>EDCore.ED_bracket_threaded</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ED_bracket_threaded(mbs_vec_bra::MBS64Vector{bits, eltype}, 
    op::MBOperator, mbs_vec_ket::MBS64Vector{bits, eltype}
    )::Complex{eltype} where {bits, eltype &lt;: AbstractFloat}
ED_bracket_threaded(mbs_vec_bra::MBS64Vector{bits, eltype}, 
    op2::MBOperator, op1::MBOperator, mbs_vec_ket::MBS64Vector{bits, eltype}
    )::Complex{eltype} where {bits, eltype &lt;: AbstractFloat}</code></pre><p>(Multithread version.) Compute the bracket &lt;bra::MBS64Vector | op::MBOperator | ket::MBS64Vector&gt;</p><p>or the bracket &lt;bra::MBS64Vector | op2::MBOperator * op1::MBOperator | ket::MBS64Vector&gt;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Zou-Bo/MomentumED.jl/blob/9e0c6adca33285c4159089796a29818888f178a6/EDCore/src/multiplication.jl#L290-L301">source</a></section></article><h2 id="End"><a class="docs-heading-anchor" href="#End">End</a><a id="End-1"></a><a class="docs-heading-anchor-permalink" href="#End" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../MomentumED/api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 7 November 2025 19:37">Friday 7 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
